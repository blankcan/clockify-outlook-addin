{"version":3,"file":"settingsDialog.js","mappings":"yBAMEA,OAAOC,QAAQ,WACb,IAAMC,EAAcC,SAASC,eAAe,UACtCC,EAAmBF,SAASC,eAAe,eAC3CE,EAAiBH,SAASC,eAAe,aACzCG,EAAUJ,SAASC,eAAe,WAGlCI,ECbF,WACN,IAAMA,EAAS,CAAC,EAMhB,OAJAA,EAAOC,eAAiBT,OAAOU,QAAQC,gBAAgBC,IAAI,kBAC3DJ,EAAOK,oBAAsBb,OAAOU,QAAQC,gBAAgBC,IAAI,uBAChEJ,EAAOM,kBAAoBd,OAAOU,QAAQC,gBAAgBC,IAAI,qBAEvDJ,CACT,CDKmBO,GACTC,EAASR,EAAOC,gBAAkB,GAClCQ,EAAcT,EAAOK,qBAAuB,GAC5CK,EAAYV,EAAOM,mBAAqB,GAE9CZ,EAAYiB,MAAQH,EACpBX,EAAiBc,MAAQF,EACzBX,EAAea,MAAQD,EAEvBX,EAAQa,QAAU,WAChB,IAAMJ,EAASd,EAAYiB,MAAME,OAC3BJ,EAAcZ,EAAiBc,MAAME,OACrCH,EAAYZ,EAAea,MAAME,OAQvC,GANAC,QAAQC,IAAI,mBAAoB,CAC9BP,OAAAA,EACAC,YAAAA,EACAC,UAAAA,IAGGF,GAAWC,EAAhB,CAKA,IAAIT,EAAS,CACXC,eAAgBO,EAChBH,oBAAqBI,EACrBH,kBAAmBI,GAGtBlB,OAAOU,QAAQc,GAAGC,cAAcC,KAAKC,UAAUnB,GAR9C,MAFEoB,MAAM,yCAWV,CACF,E","sources":["webpack://office-addin-taskpane-js/./src/settings/settings-dialog.js","webpack://office-addin-taskpane-js/./src/helpers/addin-config.js"],"sourcesContent":["import { getConfig } from \"../helpers/addin-config\";\r\n\r\n  \r\n(function () {\r\n  \"use strict\";\r\n\r\n  Office.onReady(() => {\r\n    const apiKeyInput = document.getElementById(\"apiKey\");\r\n    const workspaceIdInput = document.getElementById(\"workspaceId\");\r\n    const projectIdInput = document.getElementById(\"projectId\");\r\n    const saveBtn = document.getElementById(\"saveBtn\");\r\n\r\n    // Pre-fill if settings exist\r\n    const config = getConfig(); \r\n    const apiKey = config.clockifyApiKey || \"\";\r\n    const workspaceId = config.clockifyWorkspaceId || \"\";\r\n    const projectId = config.clockifyProjectId || \"\";\r\n\r\n    apiKeyInput.value = apiKey;\r\n    workspaceIdInput.value = workspaceId; \r\n    projectIdInput.value = projectId;\r\n\r\n    saveBtn.onclick = () => {\r\n      const apiKey = apiKeyInput.value.trim();\r\n      const workspaceId = workspaceIdInput.value.trim();\r\n      const projectId = projectIdInput.value.trim();\r\n\r\n      console.log(\"Saving settings:\", {\r\n        apiKey,\r\n        workspaceId,\r\n        projectId,\r\n      });\r\n\r\n      if (!apiKey || !workspaceId) {\r\n        alert(\"API Key and Workspace ID are required.\");\r\n        return;\r\n      }\r\n\r\n      let config = {\r\n        clockifyApiKey: apiKey,\r\n        clockifyWorkspaceId: workspaceId,\r\n        clockifyProjectId: projectId,\r\n      }\r\n\r\n     Office.context.ui.messageParent(JSON.stringify(config));\r\n    };\r\n  });\r\n})();\r\n"," export function getConfig() {\r\n  const config = {};\r\n\r\n  config.clockifyApiKey = Office.context.roamingSettings.get('clockifyApiKey');\r\n  config.clockifyWorkspaceId = Office.context.roamingSettings.get('clockifyWorkspaceId');\r\n  config.clockifyProjectId = Office.context.roamingSettings.get('clockifyProjectId');\r\n\r\n  return config;\r\n}\r\n\r\nexport function setConfig(config, callback) {\r\n  Office.context.roamingSettings.set('clockifyApiKey', config.clockifyApiKey);\r\n  Office.context.roamingSettings.set('clockifyWorkspaceId', config.clockifyWorkspaceId);\r\n  Office.context.roamingSettings.set('clockifyProjectId', config.clockifyProjectId);\r\n\r\n  Office.context.roamingSettings.saveAsync(callback);\r\n}"],"names":["Office","onReady","apiKeyInput","document","getElementById","workspaceIdInput","projectIdInput","saveBtn","config","clockifyApiKey","context","roamingSettings","get","clockifyWorkspaceId","clockifyProjectId","getConfig","apiKey","workspaceId","projectId","value","onclick","trim","console","log","ui","messageParent","JSON","stringify","alert"],"sourceRoot":""}